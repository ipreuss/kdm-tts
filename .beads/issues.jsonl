{"id":"kdm-0e0","title":"Standardize module export pattern (return Module)","description":"Migrate ~48 modules from explicit export tables (return {...}) to direct return (return Module). This eliminates forgotten-export bugs where dynamic field assignments aren't visible to other modules. Priority: Showdown (HIGH - has cross-module state), then Monster, Survivor, Player, Campaign. See ARCHITECTURE.md 'Module Export Pattern' section.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-07T23:15:12.459783+01:00","updated_at":"2025-12-13T10:44:50.476747+01:00","closed_at":"2025-12-13T10:44:50.476747+01:00"}
{"id":"kdm-0er","title":"Hunt/Showdown dialogs show only enabled monsters","description":"Hunt and Showdown dialogs currently show all monsters. They should only show monsters that are currently enabled (based on expansion settings). Reduces clutter and prevents accidental selection of unavailable monsters.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-15T17:01:39.559164+01:00","updated_at":"2025-12-16T00:58:19.727599+01:00","closed_at":"2025-12-16T00:58:19.727599+01:00"}
{"id":"kdm-0kt","title":"Automate bonus monster resource rewards (e.g., The Old Master Elytra)","description":"Some monster variants award bonus monster resources in addition to standard rewards. Example: The Old Master (DBK L4) grants 'Level 3 DBK rewards + Add 4 Elytra to settlement storage.'\n\nCurrently the ResourceRewards system only supports:\n- basic (from Basic Resources deck)\n- monster (from [Monster] Resources deck)  \n- strange (from [Monster] Strange Resources deck)\n\nTo automate bonus monster resources, we'd need to add support like:\n  resources = { basic = 8, monster = 8, strange = {...}, bonusMonster = { 'Elytra', 'Elytra', 'Elytra', 'Elytra' } }\n\nThis would spawn from the monster resources deck, separate from the random monster draws.\n\nDiscovered during kdm-5zu when Elytra was incorrectly placed in strange array (Elytra is in monster deck, not strange deck).","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-15T00:59:51.199186+01:00","updated_at":"2025-12-15T01:00:00.914965+01:00"}
{"id":"kdm-0zu","title":"Hunt cleanup fails for Herb/Mineral Gathering deck","description":"When both Herb Gathering and Mineral Gathering are placed on the same hunt event space, they form a deck. Hunt cleanup then fails to clean them up if they are still present (not drawn). Likely the cleanup logic doesn't handle decks on hunt track spaces, only individual cards.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-15T16:04:49.856094+01:00","updated_at":"2025-12-16T00:18:26.153036+01:00","closed_at":"2025-12-16T00:18:26.153036+01:00"}
{"id":"kdm-32e","title":"Black Knight + Squires campaign implementation","description":"Epic: Black Knight nemesis including Squires campaign variant. Needs breakdown into smaller tasks covering: monster AI, hit locations, resources, gear, campaign-specific rules.","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-06T21:21:05.858246+01:00","updated_at":"2025-12-10T11:15:23.815226+01:00"}
{"id":"kdm-4gv","title":"Scout pillar from Gambler's Chest","description":"","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-10T11:23:38.582047+01:00","updated_at":"2025-12-10T11:24:27.621815+01:00","closed_at":"2025-12-10T11:24:27.621815+01:00"}
{"id":"kdm-4ro","title":"Showdown aftermath checklist (Won/Lost buttons)","description":"Replace single Resource Rewards button with Won/Lost buttons. Won shows monster-specific aftermath checklist (from rulebook data), spawns resources automatically, Done triggers cleanup. Lost usually just cleanup but some monsters have special defeat effects. Checklist appears north of resource area.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-15T01:06:06.27754+01:00","updated_at":"2025-12-16T16:11:49.49161+01:00","closed_at":"2025-12-16T16:11:49.49161+01:00"}
{"id":"kdm-53s","title":"Test setup helper for expansion terrain","description":"Create TTSTests/TestSetup.ttslua module with EnableExpansionTerrain(expansionName) function that merges Core + expansion terrain into Terrain Archive for TTS tests. Returns cleanup function to restore original state. Needed for expansion showdown tests (Spidicules, Dragon King, etc.).","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-10T12:30:53.153485+01:00","updated_at":"2025-12-14T00:29:06.598246+01:00","closed_at":"2025-12-14T00:29:06.598246+01:00","dependencies":[{"issue_id":"kdm-53s","depends_on_id":"kdm-li3","type":"blocks","created_at":"2025-12-10T19:39:47.523872+01:00","created_by":"daemon"}]}
{"id":"kdm-5zu","title":"Resource rewards for special monster levels","description":"Add resource rewards for special/variant monster levels that don't follow the standard L1/L2/L3 pattern.\n\n## Completed (kdm-cb7)\nWhite Lion variants now have resources:\n- The Young Lion: basic=4, monster=4\n- Radiant Lion: basic=4, monster=6\n- Beast of Sorrow: basic=4, monster=8, strange=[Iron]\n- Great Golden Cat: basic=4, monster=9\n\n## Remaining Work\n\n**White Lion:**\n- Prologue — tutorial, likely no rewards (verify)\n\n**Phoenix:**\n- Golden Eyed King of 1000 Years — needs investigation\n\n**Dragon King:**\n- Death of the Dragon King — needs investigation\n\n**Dung Beetle Knight:**\n- The Old Master — needs investigation\n\n**Sunstalker:**\n- The Great Devourer — needs investigation\n\n## User Story\n\nAs a player, after defeating a special/variant monster, I want the resource rewards button to work correctly so I receive the appropriate rewards.\n\n## Acceptance Criteria\n\n- [ ] AC1: Each special monster level has correct resource rewards OR is marked as no-rewards encounter\n- [ ] AC2: No-rewards encounters (like Prologue) hide the resource rewards button\n- [ ] AC3: Implementation matches rulebook page data\n\n## Investigation Method\n\nUse rulebook page URLs from template_workshop.json (see kdm-expansion-data skill, 'Rulebook Page Verification' section) to verify reward data for each special monster.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T23:10:29.907755+01:00","updated_at":"2025-12-15T01:41:54.387447+01:00","closed_at":"2025-12-15T01:41:54.387447+01:00","dependencies":[{"issue_id":"kdm-5zu","depends_on_id":"kdm-w1k.3","type":"blocks","created_at":"2025-12-09T23:10:45.895198+01:00","created_by":"daemon"}],"comments":[{"id":6,"issue_id":"kdm-5zu","author":"ilja","text":"Closing: Architect verified design compliance for all 5 special monster variants. Prologue, Golden Eyed King, The Old Master have correct resources; Death of Dragon King and Great Devourer correctly have no resources (story events). Design correction for Elytra verified. All tests passing (238 headless, 8 TTS).","created_at":"2025-12-15T00:41:49Z"}]}
{"id":"kdm-6sj","title":"Butcher aftermath checklists are incorrect","description":"Audit against rulebook (Core Rules state 84) found major discrepancies in Butcher victory/defeat aftermath:\n\n**Victory - Current (wrong):**\n- Survivors with insanity 3+ gain +1 courage\n- Take Butcher's Cleaver from the archive (if available)\n\n**Victory - Should be:**\n- Roll 1d10 + Butcher level for rewards (1-4: nothing, 5-8: Butcher's Cleaver + 1 Broken Lantern, 9+: Lantern Oven innovation + 3 Broken Lanterns)\n- +3 insanity as inspiration\n- Whirlwind survivors may spend XP on advancement\n- +1 Hunt XP\n- All non-deaf survivors gain +1 courage (not 'insanity 3+')\n\n**Defeat - Current (wrong):**\n- Survivors lose all insanity\n\n**Defeat - Should be:**\n- All survivors become deaf\n- All survivors gain Butcher's Servant ability\n- Lose all resources in settlement storage\n- Lose 1 random innovation\n- Skip next hunt, run Butcher's Dance story event instead\n\n**Fix:** Update Core.ttslua lines 1175-1183, 1200-1208, 1227-1235 (all 3 levels)","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-17T21:12:31.115613+01:00","updated_at":"2025-12-18T00:47:43.136389+01:00","closed_at":"2025-12-18T00:47:43.136389+01:00"}
{"id":"kdm-6u8","title":"Expansion monsters missing aftermath checklists","description":"Audit against rulebooks found that expansion monsters have aftermath defined in rulebooks but not in code:\n\n**Gorm:**\n- Defeat: Archive all consumable gear from deceased survivors' grids\n\n**Dragon King:**\n- Defeat: Choose to leave or recover remains. Leave = no Death Principle. Recover = Death Principle but survivor becomes sick, -1 population.\n- Victory L3 with Sculpture: gain Radiant Claw strange resource\n\n**Spidicules:**\n- Defeat: Do not gain Death Principle benefits for last survivor killed\n- Victory L3 with Scarification: Killing blow survivor gains ability\n\n**Dung Beetle Knight:**\n- Defeat: Nominated survivors gain +1 insanity, random disorder, must depart next settlement phase\n\n**Flower Knight:**\n- Defeat: No Death Principle benefits from losing these survivors\n- Victory L3: 1 Sleeping Virus Flower rare gear\n- Victory L3 with Petal Spiral: Ghastly Beauty + Narcissistic disorders\n\n**Sunstalker:**\n- Needs verification (image unclear)\n\n**Files to update:**\n- Expansion/Gorm.ttslua\n- Expansion/DragonKing.ttslua\n- Expansion/Spidicules.ttslua\n- Expansion/DungBeetleKnight.ttslua\n- Expansion/FlowerKnight.ttslua\n- Expansion/Sunstalker.ttslua","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-17T21:14:45.105391+01:00","updated_at":"2025-12-18T00:47:43.137288+01:00","closed_at":"2025-12-18T00:47:43.137288+01:00"}
{"id":"kdm-7nq","title":"White Gigalion expansion support","description":"Epic: Full support for White Gigalion expansion. Needs breakdown into smaller tasks covering: monster AI, hit locations, resources, gear, and any special rules.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-06T21:21:02.827237+01:00","updated_at":"2025-12-06T21:21:29.86659+01:00"}
{"id":"kdm-836","title":"Document Pattern Gear feature","description":"Create docs/features/pattern-gear.md documenting the Pattern Gear feature. Implementation is complete (13 acceptance tests passing) but feature lacks documentation. Covers: deck creation, shuffle behavior, export/import for storage and survivor grids.\n\nAfter documentation is complete, delete docs/BACKLOG.md (all open items transferred to beads, all done items will be documented).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T21:20:59.896203+01:00","updated_at":"2025-12-06T21:31:25.909686+01:00","closed_at":"2025-12-06T21:31:25.909686+01:00"}
{"id":"kdm-8uy","title":"Add White Sunlion Armor to template","description":"Add White Sunlion Armor gear cards to TTS template. This is a promo expansion (Ezra Limited Release) for People of the Sun campaigns. User has the physical cards. Low priority since it's only usable in People of the Sun. Includes: White Sunlion Mask (stats already in Core.ttslua). Research needed for full armor set pieces.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-07T10:13:43.943177+01:00","updated_at":"2025-12-07T10:13:52.087863+01:00"}
{"id":"kdm-96o","title":"Showdown terrain not found for expansion monsters","description":"During showdown setup, several expansion monsters report missing terrain:\n- Spidicules: 'Silk Nest', 'Egg Sacs'\n- Sunstalker: '2 Salt Sculptures'\n- Dung Beetle Knight: 'Resin Dung Ball'\n- Flower Knight: 'Flower Patches'\n\nThese terrains are defined in expansion data but cannot be found during Showdown.Setup(). This doesn't block the showdown or tests, but the terrain tiles don't appear on the board.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-10T03:58:16.613293+01:00","updated_at":"2025-12-10T12:09:03.136235+01:00","closed_at":"2025-12-10T12:09:03.136235+01:00"}
{"id":"kdm-aep","title":"Arc Survivor pillar from Gambler's Chest","description":"","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-10T11:23:42.794316+01:00","updated_at":"2025-12-10T11:24:27.626082+01:00","closed_at":"2025-12-10T11:24:27.626082+01:00"}
{"id":"kdm-blp","title":"Arc Survivor pillar from Gambler's Chest","description":"Implement the Arc Survivor gameplay pillar from Gambler's Chest expansion. Arc Survivors have progression arcs with branching paths.","status":"open","priority":3,"issue_type":"epic","created_at":"2025-12-10T11:24:45.961868+01:00","updated_at":"2025-12-10T11:24:45.961868+01:00"}
{"id":"kdm-cb7","title":"Add resource rewards for special White Lion variants","description":"Special White Lion variants (The Young Lion, Radiant Lion, Beast of Sorrow) should also have resource rewards defined. Currently only the standard Level 1/2/3 variants have rewards data. This is follow-up work after kdm-w1k.1 is complete.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-07T21:10:21.632356+01:00","updated_at":"2025-12-14T20:03:14.18444+01:00","closed_at":"2025-12-14T20:03:14.18444+01:00","dependencies":[{"issue_id":"kdm-cb7","depends_on_id":"kdm-w1k.1","type":"blocks","created_at":"2025-12-07T21:10:26.350943+01:00","created_by":"daemon"}],"comments":[{"id":4,"issue_id":"kdm-cb7","author":"ilja","text":"Closing: Architect verified design compliance — all 4 White Lion variants have correct resources fields matching design spec. TTS tests verified by user. 238/238 headless tests pass.","created_at":"2025-12-14T18:43:55Z"},{"id":5,"issue_id":"kdm-cb7","author":"ilja","text":"Reopened: Architect incorrectly closed this as 'technical task'. This is user-facing functionality (resource rewards), so PO should validate and close.","created_at":"2025-12-14T18:52:56Z"}]}
{"id":"kdm-ee9","title":"Wanderer pillar from Gambler's Chest","description":"","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-10T11:23:40.646526+01:00","updated_at":"2025-12-10T11:24:27.623846+01:00","closed_at":"2025-12-10T11:24:27.623846+01:00"}
{"id":"kdm-fgd","title":"Document TTS coordinate system and positioning","description":"TTS coordinate system is unintuitive and positioning UI/objects is difficult.\n\n## Approach\nCreate visual documentation using annotated screenshots:\n1. **Location overlay screenshot**: Mark key board positions (showdown board, settlement board, rulebook, resource spawn areas) with colored rectangles and coordinate labels\n2. **Grid overlay screenshot**: Show a colored grid with coordinate scale to understand distances\n\n## Deliverables\n1. Annotated screenshots in docs/ folder\n2. Document coordinate system in ARCHITECTURE.md:\n   - Origin location, axis directions, scale\n   - Common reference points with coordinates\n   - How 3D UI coordinates relate to world coordinates\n3. Optional: Console command to show coordinates in real-time (e.g., \u003eshowpos)\n\n## Value\nSaves time on future UI/object positioning. Current pain point: ResourceRewards button positioning (kdm-w1k.1).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T13:55:03.990858+01:00","updated_at":"2025-12-08T14:40:55.769122+01:00","closed_at":"2025-12-08T14:40:55.769122+01:00"}
{"id":"kdm-fl2","title":"Overhaul TTS test framework with selective test execution","description":"Complete overhaul of the TTS test framework to support selective test execution, bead-based test suites, and automatic error detection.\n\n## User Stories\n\n### US1: Run single test by name\nAs a developer\nI want to run a specific test by its name\nSo that I can quickly verify a single behavior without running the entire suite\n\n### US2: Run tests for a bead\nAs a developer  \nI want to run all tests associated with a specific bead ID\nSo that I can verify all behaviors related to a feature before handover\n\n### US3: Run current bead tests (shortcut)\nAs a developer\nI want a shortcut to run tests for the 'currently worked on' bead\nSo that I don't have to type the bead ID repeatedly during development\n\n### US4: Smart test ordering\nAs a developer\nI want to run current bead tests first, then all other tests (only if bead tests pass)\nSo that I get fast feedback on my changes while still ensuring no regressions\n\n### US5: Auto-fail on error logs\nAs a developer\nI want tests to automatically fail when error-level messages are logged\nSo that hidden errors don't slip through even when assertions pass\n\n## Acceptance Criteria\n\n### AC1: Single test execution\n- [ ] Console command \"\u003etestrun \u003ctest_name\u003e\" runs exactly one test\n- [ ] Clear feedback if test name not found\n- [ ] Reports pass/fail with execution time\n\n### AC2: Bead-based test suites  \n- [ ] Tests can be tagged with one or more bead IDs\n- [ ] Console command \"\u003etestsuite \u003cbead_id\u003e\" runs all tests for that bead\n- [ ] Reports which tests belong to the bead\n- [ ] Reports pass/fail summary\n\n### AC3: Current bead shortcut\n- [ ] Mechanism to set 'current bead' (Architect decides: config, branch, or other)\n- [ ] Console command \"\u003etestcurrent\" runs tests for current bead\n- [ ] Clear error if no current bead is set\n\n### AC4: Smart test ordering\n- [ ] Console command \"\u003etestpriority\" or similar\n- [ ] Runs current bead tests first\n- [ ] If all pass, runs remaining tests\n- [ ] If bead tests fail, stops and reports (doesn't run other tests)\n- [ ] Summary shows bead tests vs other tests separately\n\n### AC5: Error log detection\n- [ ] Any error-level log during test execution causes test failure\n- [ ] Error message included in failure report\n- [ ] Works regardless of whether test assertions pass\n\n## Open Questions (for Architect)\n- How to determine 'current bead' - config file, git branch parsing, or other mechanism?\n- Should bead tagging be inline in test code or in a separate registry?\n- Integration with existing \u003etestall and \u003etestfocus commands?","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-10T16:20:42.694315+01:00","updated_at":"2025-12-10T19:06:36.547911+01:00","closed_at":"2025-12-10T19:06:36.547911+01:00","dependencies":[{"issue_id":"kdm-fl2","depends_on_id":"kdm-53s","type":"blocks","created_at":"2025-12-10T16:23:16.704812+01:00","created_by":"daemon"}]}
{"id":"kdm-fl2.1","title":"Test discovery commands (testsuite list, testlist)","description":"Add commands to discover and list available tests in the TTS test framework.\n\n## User Story\n\n**As a** developer\n**I want** to see what tests are available and which beads they belong to\n**So that** I can understand test coverage and run targeted test subsets\n\n## Proposed Commands\n\n### \u003etestlist\nLists all registered tests with their names.\n\n### \u003etestsuite list\nLists all bead IDs that have associated tests.\n\n### \u003etestsuite \u003cbead_id\u003e\nShows which tests are tagged with a specific bead ID.\n\n## Acceptance Criteria\n\n1. **AC1: List all tests**\n   - Console command `\u003etestlist` shows all registered test names\n   - Output is readable and sorted\n\n2. **AC2: List bead test suites**\n   - Console command `\u003etestsuite list` shows all beads with tests\n   - Shows count of tests per bead\n\n3. **AC3: Show tests for bead**\n   - Console command `\u003etestsuite \u003cbead_id\u003e` lists tests for that bead\n   - Clear message if bead has no tests\n\n## Technical Context\n\n- TTS test framework: `TTSTests/`\n- Test registration: `TTSTests/TestRunner.ttslua`\n- Tests currently use `ALL_TESTS` table\n- Need to add bead tagging mechanism to test registration\n\n## Open Questions (for Architect)\n\n- Should bead tags be inline in test code or separate registry?\n- Format for test output (simple list vs table with metadata)?\n- Should this integrate with the existing `\u003etestfocus` command?","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-10T16:50:37.631723+01:00","updated_at":"2025-12-13T23:54:12.824925+01:00","closed_at":"2025-12-13T23:54:12.824925+01:00"}
{"id":"kdm-fl2.2","title":"Auto-fail tests on error log detection","description":"Implement automatic test failure when error-level logs are detected during test execution.\n\n## User Story (from parent kdm-fl2)\n\n**US5: Auto-fail on error logs**\nAs a developer\nI want tests to automatically fail when error-level messages are logged\nSo that hidden errors don't slip through even when assertions pass\n\n## Acceptance Criteria (AC5)\n\n- [ ] Any error-level log during test execution causes test failure\n- [ ] Error message included in failure report\n- [ ] Works regardless of whether test assertions pass\n\n## Why Critical\n\nWithout this, tests can pass while hiding real errors. For example:\n- A nil access logs an error but the test catches the exception\n- An Archive operation fails silently with an error log\n- A callback encounters an error but test assertions still pass\n\nThis creates false confidence in test results and allows bugs to slip through.\n\n## Technical Context\n\nThe TTS test framework is in `TTSTests/`. Error logging uses the `Log` module. The test runner needs to intercept error-level logs and convert them to test failures.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-10T16:50:51.079661+01:00","updated_at":"2025-12-13T11:48:06.719678+01:00","closed_at":"2025-12-13T11:48:06.719678+01:00"}
{"id":"kdm-gmk","title":"Dynamic hunt party from survivor figurines","description":"Replace the static \"Hunt Party\" token with a dynamic group composed of scaled-down copies of the departing survivors' figurines.\n\n## User Story\n\nAs a player, I want to see my actual survivor figurines on the hunt track instead of a generic token, so that the hunt feels more immersive and personalized.\n\n## Acceptance Criteria\n\n**AC1: Figurine copying**\n- When hunt starts, survivor figurines are copied from departing survivors\n- Original figurines remain on player boards unchanged\n\n**AC2: Scaling**\n- Copies are scaled down to appropriate size (e.g., ~50%) so grid fits in one track space\n\n**AC3: Grid arrangement**\n- Copies arranged based on party size:\n  - 1 survivor: single figurine centered\n  - 2 survivors: side by side (1x2)\n  - 3 survivors: triangle formation (1 front, 2 back — arrow pointing toward monster)\n  - 4 survivors: 2x2 grid\n\n**AC4: Grouping**\n- All copies grouped into single movable object\n- Group behaves like the old \"Hunt Party\" token for movement\n\n**AC5: Rotation**\n- Group rotated to face east (toward monster end of track)\n\n**AC6: Placement**\n- Group placed at party starting position on hunt track (same as current Hunt Party token)\n\n**AC7: Missing figurines**\n- Survivors without assigned figurines are skipped (no error, just fewer in group)\n- If NO survivors have figurines, fall back to standard Hunt Party token\n\n**AC8: Cleanup**\n- Group auto-deleted during hunt cleanup (Hunt.Clean)\n\n**AC9: Dynamic party updates**\n- When a survivor leaves the party during hunt (death or return to settlement), their figurine is automatically removed from the group\n- System detects survivor departure events automatically\n\n**AC10: Formation rearrangement on removal**\n- When a figurine is removed, remaining figurines rearrange to appropriate formation\n- 4→3: 2x2 grid → triangle (1 front, 2 back)\n- 3→2: triangle → side by side\n- 2→1: side by side → single centered\n\n**AC11: Last survivor edge case**\n- If last figurine is removed, group is deleted (empty hunt party)\n- Consider: should this trigger hunt end or is it handled elsewhere?\n\n## Open Questions (for Architect)\n\n1. How to access departing survivor figurines? (Player.FigurineObject, FigurineJSON, or other?)\n2. TTS grouping mechanism — use built-in group or custom container?\n3. Scaling approach — setScale on copies or spawn at smaller scale?\n4. Formation layout math — hardcoded positions or calculated?\n5. Does FigurineJSON always exist for survivors with figurines?\n6. How to detect survivor death/return events during hunt?\n7. How to map a departing survivor to their figurine copy in the group?\n\n## Technical Context\n\n- Hunt setup: Hunt.ttslua, Hunt.Setup()\n- Current Hunt Party: Archive.Take({ name = \"Hunt Party\", type = \"Hunt Party\", ... })\n- Survivor figurine data: Survivor.ttslua, SurvivorClass:FigurineJSON()\n- Player figurine: Player.ttslua, Player:FigurineObject()\n- Departing survivors: Survivor.GetDepartingSurvivors()\n\n## Priority\n\nP3 — Visual enhancement, not blocking other work.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-13T23:59:10.744309+01:00","updated_at":"2025-12-17T20:29:10.776412+01:00","closed_at":"2025-12-17T20:29:10.776412+01:00"}
{"id":"kdm-hxd","title":"Cross-check showdown rewards against rulebook pages","description":"Systematically verify all monster resource rewards in the mod against official rulebook pages. Use the discovery that rulebook pages are accessible via steamusercontent URLs in template_workshop.json (see LEARNINGS.md 2025-12-14). For each monster: 1) Find rules state in showdown definition, 2) Look up URL in template_workshop.json, 3) Download and verify rewards match implementation. Also document any aftermath automation opportunities discovered (victory bonuses, story events, gear rewards beyond basic/monster resources).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-14T20:05:06.373965+01:00","updated_at":"2025-12-17T21:00:14.492759+01:00","closed_at":"2025-12-17T21:00:14.492759+01:00"}
{"id":"kdm-i3z","title":"Auto-reveal hunt cards on party movement","description":"Automatically reveal hunt event cards when the Hunt Party figurine enters a new space on the hunt track.\n\n## User Story\n\nAs a player, I want hunt event cards to automatically reveal when my hunting party enters a new space, so that I don't have to manually flip cards during the hunt.\n\n## Acceptance Criteria\n\n**AC1: Position detection**\n- When Hunt Party lands on a hunt track space, system detects the new position\n\n**AC2: Face-down card reveal**\n- Face-down card on that space is flipped and moved to \"Hunt Cards\" area for readability\n\n**AC3: Face-up card handling**\n- Face-up cards (special events like Forest Gate, Labyrinth) are also moved to \"Hunt Cards\" area for readability\n\n**AC4: Multi-card handling**\n- If multiple cards on space, reveal top card first\n- \"Next Card\" button appears to reveal subsequent cards\n- Button disappears when all cards revealed\n\n**AC5: Empty space handling**\n- Empty spaces (Overwhelming Darkness 'O') don't trigger anything\n\n## Open Questions (for Architect)\n\n1. Detection mechanism: snap point events vs. onObjectDrop vs. other TTS events?\n2. Is there a distinction between drag and snap that matters for detection?\n3. Location of \"Hunt Cards\" display area — reuse existing Location or create new?\n4. Button implementation for \"Next Card\" — UI element or object-based?\n\n## Technical Context\n\n- Hunt setup: Hunt.ttslua\n- Hunt track spaces: \"Hunt Track 1\", \"Hunt Track 2\", etc.\n- Card types: \"Hunt Events\", \"Monster Hunt Events\", \"Special Hunt Events\"\n- Hunt Party figurine snaps to track positions\n\n## Priority\n\nP3 — Quality-of-life improvement, not blocking other work.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-13T23:39:02.065753+01:00","updated_at":"2025-12-15T18:29:43.058071+01:00","closed_at":"2025-12-15T18:29:43.058071+01:00"}
{"id":"kdm-i3z.1","title":"TTS tests for card reveal order (top card first)","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-15T17:09:12.761022+01:00","updated_at":"2025-12-15T17:09:46.373923+01:00","closed_at":"2025-12-15T17:09:46.373923+01:00","dependencies":[{"issue_id":"kdm-i3z.1","depends_on_id":"kdm-i3z","type":"parent-child","created_at":"2025-12-15T17:09:12.762489+01:00","created_by":"daemon"}]}
{"id":"kdm-i47","title":"Aftermath checklist semi-automation","description":"Epic to explore automating aftermath checklist items (auto-increment hunt XP, courage, understanding, etc.) instead of pure manual checkboxes. Depends on aftermath checklist feature being implemented first. Break down once we understand scope better.","status":"open","priority":3,"issue_type":"epic","created_at":"2025-12-15T01:06:07.791952+01:00","updated_at":"2025-12-15T01:06:07.791952+01:00","dependencies":[{"issue_id":"kdm-i47","depends_on_id":"kdm-4ro","type":"blocks","created_at":"2025-12-15T01:06:13.134152+01:00","created_by":"daemon"}]}
{"id":"kdm-ju4","title":"Scout pillar from Gambler's Chest","description":"Implement the Scout gameplay pillar from Gambler's Chest expansion. Scouts explore the world and discover new locations.","status":"open","priority":3,"issue_type":"epic","created_at":"2025-12-10T11:24:41.650119+01:00","updated_at":"2025-12-10T11:24:41.650119+01:00"}
{"id":"kdm-k70","title":"Add selective invariant assertions to high-risk modules","description":"Add targeted assertion guards at high-risk points identified in Design by Contract analysis.\n\n## Scope\n\nAdd invariant checks to these modules (HIGH priority from analysis):\n\n### 1. Archive.ttslua - ensureContainer()\nAssert container valid after spawn attempt. Prevents silent nil returns and duplicate card spawning.\n\n### 2. Location.ttslua - state mutations  \nAssert bidirectional consistency (object↔location mapping) after add/remove operations. Prevents ghost references.\n\n### 3. Global.ttslua - PostInit()\nAssert dependencies initialized before access. Addresses active bug noted in comments (line 125).\n\n### 4. Container.ttslua - Take()\nAssert object valid before TTS API call. Prevents silent failures when object becomes nil mid-operation.\n\n### 5. Monster.ttslua - UpdateStats()\nAssert token stat accumulation consistency. Ensures displayed stats match calculation.\n\n## Implementation Notes\n\n- Use simple assert() with descriptive messages\n- Only check at module boundaries and state transitions\n- Keep runtime overhead minimal (these are guards, not full DbC)\n- ~4-5 targeted assertions total\n\n## Acceptance Criteria\n\n- [ ] Each HIGH priority module has at least one invariant assertion\n- [ ] Assertions have clear error messages identifying the violation\n- [ ] No measurable performance impact during normal operation\n- [ ] Tests pass (assertions should not fire on valid code paths)","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-15T00:47:56.652147+01:00","updated_at":"2025-12-15T00:47:56.652147+01:00"}
{"id":"kdm-klf","title":"Hunt card reveal order wrong - top card revealed second","description":"When Herb Gathering is placed on top of a hunt card, it should be revealed first (top card). Instead, the bottom card is revealed first. The reveal order is inverted - should reveal top-to-bottom, currently reveals bottom-to-top.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-15T17:02:58.411732+01:00","updated_at":"2025-12-15T17:03:15.270862+01:00","closed_at":"2025-12-15T17:03:15.270862+01:00"}
{"id":"kdm-li3","title":"Unknown Error during TestSetup terrain cleanup","description":"After TestSpidiculesStrangeResourcesSpawn test completes, an Unknown Error appears during terrain cleanup. Seen in TTS console during kdm-fl2 testing but unrelated to test framework changes.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-10T18:49:57.91344+01:00","updated_at":"2025-12-10T23:00:49.309032+01:00","closed_at":"2025-12-10T23:00:49.309032+01:00"}
{"id":"kdm-lpk","title":"Explore automation for showdown victory bonuses","description":"Some showdowns grant special victory bonuses beyond standard resources: rare gear, survivors joining settlement, fighting arts (specific or random), permanent stat bonuses, timeline events. Examples: (1) The Young Lion grants Cola Bottle Lantern + Candy \u0026 Cola survivor joins. (2) Radiant Lion grants Arm of the First Tree + White Speaker story event on timeline. (3) Beast of Sorrow grants random fighting art (face down so player can't see before choosing recipient). (4) Great Golden Cat grants +2 permanent strength + Timeless Eye + Combo Master to killing blow survivor. Should we automate these? Options: (a) Manual - players handle it, (b) Info display - show what bonuses apply, (c) Full automation - spawn gear/cards, create survivors, add timeline events. Special consideration: face-down cards for hidden selection. Needs Product Owner input on scope.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-14T11:22:35.107252+01:00","updated_at":"2025-12-14T11:25:58.565028+01:00","dependencies":[{"issue_id":"kdm-lpk","depends_on_id":"kdm-cb7","type":"blocks","created_at":"2025-12-14T11:22:40.493499+01:00","created_by":"daemon"}]}
{"id":"kdm-mir","title":"TTS tests quiet mode to reduce console output","description":"Add a quiet mode option for TTS console tests that reduces verbose output. Currently tests log every step (setup, checks, found objects, cleanup) which creates a lot of noise. A quiet mode would:\n- Only show test name and PASSED/FAILED result\n- Show full output only for failed tests\n- Could be toggled via \u003etestall quiet or a config flag\n\nThis would make it easier to scan test results and spot failures.","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-10T04:00:02.582698+01:00","updated_at":"2025-12-10T11:15:29.724799+01:00"}
{"id":"kdm-o1z","title":"Encounter pillar from Gambler's Chest","description":"","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-10T11:23:36.506592+01:00","updated_at":"2025-12-10T11:24:27.614966+01:00","closed_at":"2025-12-10T11:24:27.614966+01:00"}
{"id":"kdm-pld","title":"Add paired weapon support to integrity tests","description":"The template_archive_integrity_test.lua checks that items in expansion code exist in the template. Currently paired weapons (Bone Hatchet, Tempered Axe, Aya's) fail because code has base name but template has [left]/[right] variants. Add logic to handle paired weapons: if an item has 'paired = true' in weaponStats, check for either the base name OR '[left]'/[right]' variants in template.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-07T10:31:06.422172+01:00","updated_at":"2025-12-07T11:00:48.327305+01:00","closed_at":"2025-12-07T11:00:48.327305+01:00"}
{"id":"kdm-q3s","title":"Showdown dialog doesn't show levels beyond 2 for White Lion","description":"When opening the showdown dialog for White Lion, only levels up to Level 2 are shown. Level 3 and other variants (Beast of Sorrow, etc.) are not displayed in the selection.\n\n## Steps to Reproduce\n1. Open showdown dialog\n2. Select White Lion\n3. Observe available levels\n\n## Expected\nAll White Lion levels should be visible: Prologue, The Young Lion, Level 1, Level 2, Level 3, Radiant Lion, Beast of Sorrow\n\n## Actual\nOnly levels up to Level 2 are shown","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-07T21:11:33.818351+01:00","updated_at":"2025-12-08T18:52:06.885804+01:00","closed_at":"2025-12-08T18:52:06.885804+01:00"}
{"id":"kdm-q9u","title":"Test suite discovery improvements","description":"Two improvements for \u003etestsuite command: (1) Show bead summaries alongside IDs - requires build-time lookup table since TTS has no filesystem access. (2) Add domain-based suites (strain, dialog, milestone, resources) in addition to bead-based suites. Architect decision needed on approach.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-13T23:49:12.024919+01:00","updated_at":"2025-12-14T10:35:41.344576+01:00","closed_at":"2025-12-14T10:35:41.344576+01:00","comments":[{"id":3,"issue_id":"kdm-q9u","author":"ilja","text":"Closing: Architect verified design compliance. All 4 console commands implemented, TestRegistry pattern appropriate, BeadTitles auto-generation working. 4/6 domains used (acceptable per growth policy). Code review APPROVED with 238 headless tests passing.","created_at":"2025-12-14T09:35:35Z"}]}
{"id":"kdm-rbl","title":"Fix missing gear/armor/weapon items in data","description":"Fix missing gear/armor/weapon items in template or expansion data.\n\n## Armor Items\n| Item | Expansion | Issue |\n|------|-----------|-------|\n| Vagabond Armor | Core | Not in template |\n| White Sunlion Mask | Core | Not in template |\n| God Mask (CE) | Community Edition | Non-CE variant 'God Mask' exists |\n| Phoenix Mask (CE) | Community Edition | Non-CE variant 'Phoenix Mask' exists |\n| White Lion Mask (CE) | Community Edition | Non-CE variant 'White Lion Mask' exists |\n| Antelope Mask (CE) | Community Edition | Non-CE variant 'Antelope Mask' exists |\n| Man Mask (CE) | Community Edition | Non-CE variant 'Man Mask' exists |\n| Flower Knight Costume | Flower Knight | Not in template |\n\n## Weapon Items\n| Item | Expansion | Issue |\n|------|-----------|-------|\n| Aya's | Core | Incomplete name - should be 'Aya's Spear' or 'Aya's Sword' |\n| Bone Hatchet | Core | Paired weapon - template has [left]/[right] variants |\n| Tempered Axe | Core | Paired weapon - template has [left]/[right] variants |\n| Thunder Maul | Core | Only CE variant exists - template has 'Thunder Maul (CE)' |\n\n## Notes\n- Paired weapons: The game tracks left/right hand variants separately. Code may need to handle [left]/[right] suffixes.\n- CE variants: Community Edition items have (CE) suffix. Non-CE variants should be used if CE expansion is disabled.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T21:21:01.8445+01:00","updated_at":"2025-12-07T19:34:36.586786+01:00","closed_at":"2025-12-07T19:34:36.586786+01:00"}
{"id":"kdm-rbl.1","title":"Fix missing/incorrect item names in expansion data","description":"Fix items that are missing from template or have wrong names in expansion code:\n- Vagabond Armor (Core) — not in template\n- White Sunlion Mask (Core) — not in template\n- Flower Knight Costume (Flower Knight) — not in template\n- Aya's (Core) — incomplete name, should be 'Aya's Spear' or 'Aya's Sword'\n- Bone Hatchet (Core) — paired weapon, code should reference [left]/[right] variants\n- Tempered Axe (Core) — paired weapon, code should reference [left]/[right] variants","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T21:44:03.14501+01:00","updated_at":"2025-12-07T10:32:26.607557+01:00","closed_at":"2025-12-07T10:32:26.607557+01:00","dependencies":[{"issue_id":"kdm-rbl.1","depends_on_id":"kdm-rbl","type":"parent-child","created_at":"2025-12-06T21:44:03.145757+01:00","created_by":"daemon"}]}
{"id":"kdm-rbl.2","title":"Archive CE expansion and remove CE variant references","description":"Community Edition expansion adds complexity without benefit. Archive/disable it:\n- Move CE expansion to archive folder\n- Remove CE variant items from active data (God Mask (CE), Phoenix Mask (CE), White Lion Mask (CE), Antelope Mask (CE), Man Mask (CE), Thunder Maul (CE))\n- Ensure non-CE originals work correctly","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T21:44:04.100183+01:00","updated_at":"2025-12-06T21:51:54.153714+01:00","closed_at":"2025-12-06T21:51:54.153714+01:00","dependencies":[{"issue_id":"kdm-rbl.2","depends_on_id":"kdm-rbl","type":"parent-child","created_at":"2025-12-06T21:44:04.100998+01:00","created_by":"daemon"}]}
{"id":"kdm-rbl.3","title":"Allow pairing weapons with different names","description":"Allow Aya's Spear and Aya's Sword to be paired despite having different names.\n\n## User Story\nAs a player, when I equip Aya's Spear and Aya's Sword together, I want them to be recognized as a paired weapon set so that I get the pairing bonuses.\n\n## Context\n- Currently only weapons with identical names can pair\n- Aya's weapons are the only case needing cross-name pairing\n- Template needs 'Aya's Spear' and 'Aya's Sword' added (don't exist yet)\n- Code currently has incomplete name 'Aya's'\n\n## Acceptance Criteria\n- [ ] Aya's Spear and Aya's Sword can be paired\n- [ ] Existing same-name pairing still works (Bone Hatchet, Tempered Axe)\n- [ ] Template contains Aya's Spear and Aya's Sword","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-07T09:46:49.934811+01:00","updated_at":"2025-12-07T19:34:34.968847+01:00","closed_at":"2025-12-07T19:34:34.968847+01:00"}
{"id":"kdm-rhc","title":"Refactor ResourceRewardsTests DRY violations","description":"Extract shared validation logic from DataIntegrity tests (9 functions with identical loops) and replace magic coordinates with Location API. See HANDOVER_REVIEWER_ARCHITECT_W1K3_DESIGN_COMPLIANCE.md for details.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-10T04:09:55.326385+01:00","updated_at":"2025-12-13T09:44:23.152545+01:00","closed_at":"2025-12-13T09:44:23.152545+01:00"}
{"id":"kdm-s8x","title":"Nukealope quarry/nemesis implementation","description":"Epic: Implementation of Nukealope quarry/nemesis. Needs breakdown into smaller tasks covering: monster AI, hit locations, resources, gear, and any special rules.","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-06T21:21:04.827279+01:00","updated_at":"2025-12-10T11:15:25.749581+01:00"}
{"id":"kdm-sey","title":"Screaming Antelope L3 spawns incorrect vermin rewards","description":"Audit against rulebook (kdm-hxd) found discrepancy:\n\n**Code:** resources = { basic = 5, monster = 7, vermin = 2, strange = { \"Black Lichen\" } }\n**Rulebook:** 5 basic, 7 Screaming Antelope, 1 Black Lichen strange resource\n\nThe code incorrectly adds vermin = 2 which is not in the rulebook rewards table for Screaming Antelope Level 3.\n\n**Fix:** Remove vermin = 2 from Screaming Antelope L3 showdown resources in Core.ttslua line 1602.\n\n**Source:** Core Rules state 88 (Showdown: Screaming Antelope)","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-17T21:00:04.614315+01:00","updated_at":"2025-12-18T00:47:43.130874+01:00","closed_at":"2025-12-18T00:47:43.130874+01:00"}
{"id":"kdm-tdo","title":"Encounter pillar from Gambler's Chest","description":"Implement the Encounter gameplay pillar from Gambler's Chest expansion. Encounters are triggered events during settlement phase.","status":"open","priority":3,"issue_type":"epic","created_at":"2025-12-10T11:24:39.494843+01:00","updated_at":"2025-12-10T11:24:39.494843+01:00"}
{"id":"kdm-tq6","title":"Sunstalker aftermath blocks missing","description":"Sunstalker expansion file has no aftermath blocks defined. Per rulebook verification:\n\n**All Levels - Victory:**\n- +1 Hunt XP\n- +1 Weapon Proficiency (if eligible)\n- Collect resources\n- First victory: Gain Skyreef Sanctuary settlement location\n\n**All Levels - Defeat:**\n- If settlement has Graves innovation, gain Shadow Dance innovation\n\n**Level 3 ONLY - Additional Victory:**\n- If settlement has Storytelling innovation and this is first L3 victory: Add Edged Tonometry settlement event to timeline next year\n\n**Also discovered:** Strange resources in code missing 'Old':\n- Code: '1,000 Year Sunspot' → Should be: '1,000 Year Old Sunspot'\n- Code: '3,000 Year Sunspot' → Should be: '3,000 Year Old Sunspot'\n\nFile: Expansion/Sunstalker.ttslua lines 337-410","status":"open","priority":3,"issue_type":"bug","created_at":"2025-12-18T00:32:29.568486+01:00","updated_at":"2025-12-18T01:11:12.023506+01:00"}
{"id":"kdm-tyu","title":"Killenium Butcher nemesis implementation","description":"Epic: Implementation of Killenium Butcher nemesis. Needs breakdown into smaller tasks covering: monster AI, hit locations, resources, gear, and any special rules.","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-06T21:21:03.821759+01:00","updated_at":"2025-12-10T11:15:27.729662+01:00"}
{"id":"kdm-ubf","title":"Wanderer pillar from Gambler's Chest","description":"Implement the Wanderer gameplay pillar from Gambler's Chest expansion. Wanderers are special survivors with unique mechanics.","status":"open","priority":3,"issue_type":"epic","created_at":"2025-12-10T11:24:43.747331+01:00","updated_at":"2025-12-10T11:24:43.747331+01:00"}
{"id":"kdm-v1q","title":"Resin Dung Ball terrain not found during DBK showdown setup","description":"During Dung Beetle Knight showdown setup (The Old Master level), the terrain 'Resin Dung Ball' cannot be found in the deck. Error message: 'Couldn't find terrain Resin Dung Ball in deck. Check if expansion terrain is being merged.' This is a pre-existing issue unrelated to kdm-5zu resource rewards work. Discovered during TTS testing of The Old Master strange resources.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-15T01:17:08.761408+01:00","updated_at":"2025-12-15T01:18:06.330223+01:00","closed_at":"2025-12-15T01:18:06.330223+01:00"}
{"id":"kdm-w1k","title":"Showdown resource rewards button","description":"Add a button to spawn resource rewards after winning a showdown.\n\n## User Story\n\nAs a player, after winning a showdown, I want to press a button that automatically draws my resource rewards so that I don't have to manually search through resource decks.\n\n## Current Pain Point\n\nAfter winning a showdown, players must:\n1. Look up which resources they earned (basic + monster-specific)\n2. Manually search through the basic resource deck\n3. Manually search through the monster resource deck\n4. Draw the correct number of random cards from each\n\n## Requirements\n\n### Button Location\n- Far right of the Rules Navigation Board (row 2, same as Back/Prev/Next buttons)\n\n### Button Availability\n- Available from showdown start until cleanup phase\n- Hidden if monster has no resource rewards\n\n### Behavior\nWhen pressed:\n1. Determine active showdown (monster type + level)\n2. Look up resource rewards for that monster/level (from rulebook data)\n3. Draw random cards from the EXISTING decks on showdown board:\n   - Basic resource deck (number depends on monster/level)\n   - Monster-specific resource deck (number depends on monster/level)\n4. Spawn drawn cards to the left of the settlement board\n\n### Design Decision: Use Existing Decks\nResources MUST be drawn from the already-spawned decks on the showdown board, NOT from fresh decks from the archive. Reason: During the showdown, events may allow players to take resources early (e.g., trap cards). Those resources are no longer available as post-showdown rewards. Drawing from existing decks ensures we only give what's actually left.\n\n### Multiple Press Handling\n- First press: spawn resources immediately\n- Subsequent presses: show confirmation dialog warning that resources were already spawned\n\n### Data Requirements\n- Reward data per monster per level (from rulebook):\n  - Number of basic resources to draw\n  - Number of monster-specific resources to draw\n- Monster type + level determined by active showdown\n\n## Acceptance Criteria\n\n- [ ] Button appears on far right of Rules Navigation Board when showdown starts\n- [ ] Button styled consistently with other Rules Navigation buttons (DARK_BROWN background, LIGHT_BROWN text)\n- [ ] Button hidden if monster has no resource rewards\n- [ ] Button spawns correct number of basic resources for current monster/level\n- [ ] Button spawns correct number of monster resources for current monster/level\n- [ ] **Resources drawn from EXISTING decks on showdown board** (not archive) - run \u003etestrewardsexisting\n- [ ] Resources spawn to designated area (left of settlement board)\n- [ ] Second press shows confirmation dialog before spawning again\n- [ ] Button hidden when showdown ends\n- [ ] Works for White Lion (at minimum for initial implementation)\n\n## TTS Test Commands\n\n- `\u003etestrewardsbutton` - Verify button appears on showdown start\n- `\u003etestrewardshidden` - Verify button hidden for monsters without resources\n- `\u003etestrewardsspawn` - Verify resource data integrity\n- `\u003etestrewardsexisting` - Verify draws from existing decks (not archive)","notes":"## Current State (2025-12-08)\n\n### What Works:\n- ✅ Button appears on far right of Rules Navigation Board (row 2)\n- ✅ Button styled consistently with other Rules buttons (DARK_BROWN/LIGHT_BROWN)\n- ✅ Button shows on showdown start, hides on showdown end\n- ✅ Button hidden for monsters without resources (e.g., Prologue)\n- ✅ Draws from EXISTING decks on showdown board (not archive)\n- ✅ Confirmation dialog on second press\n- ✅ Test command: \u003etestrewardsexisting verifies existing deck behavior\n\n### Known Issue:\n- ❌ Resources spawn ON the showdown board instead of LEFT of settlement board\n- LocationData[\"Resource Rewards\"] is set to x=-10, y=2, z=0 which should be left of settlement board\n- But cards still appear on showdown board - need to investigate why\n\n### Files Modified:\n- ResourceRewards.ttslua - Main module\n- LocationData.ttslua - Spawn location definition\n- TTSTests/ResourceRewardsTests.ttslua - TTS integration tests\n- ARCHITECTURE.md - Documentation\n\n### Next Steps:\n1. Debug why cards spawn at wrong location (possibly Container:Take behavior?)\n2. May need to use different spawn mechanism or adjust coordinates further","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-06T21:21:00.866144+01:00","updated_at":"2025-12-08T18:53:49.510947+01:00","closed_at":"2025-12-08T18:53:49.510947+01:00"}
{"id":"kdm-w1k.1","title":"White Lion resource rewards (proof of concept)","description":"Implement resource rewards button for White Lion only. Basic resources (4) and monster resources (4/6/8 by level). Validates core mechanism before expanding to other monsters.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-07T19:58:13.113418+01:00","updated_at":"2025-12-08T16:37:43.164452+01:00","closed_at":"2025-12-08T16:37:43.164452+01:00","dependencies":[{"issue_id":"kdm-w1k.1","depends_on_id":"kdm-w1k","type":"parent-child","created_at":"2025-12-07T19:58:13.114595+01:00","created_by":"daemon"},{"issue_id":"kdm-w1k.1","depends_on_id":"kdm-fgd","type":"blocks","created_at":"2025-12-08T14:04:57.684883+01:00","created_by":"daemon"}]}
{"id":"kdm-w1k.2","title":"Strange resource rewards (named cards)","description":"Add support for spawning named strange resources (e.g., Elder Cat Teeth for White Lion Level 3). Requires different spawning logic than random deck draws.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-07T19:58:32.749243+01:00","updated_at":"2025-12-08T23:25:08.264896+01:00","closed_at":"2025-12-08T23:25:08.264896+01:00","dependencies":[{"issue_id":"kdm-w1k.2","depends_on_id":"kdm-w1k","type":"parent-child","created_at":"2025-12-07T19:58:32.750489+01:00","created_by":"daemon"},{"issue_id":"kdm-w1k.2","depends_on_id":"kdm-w1k.1","type":"blocks","created_at":"2025-12-07T19:58:51.632088+01:00","created_by":"daemon"}]}
{"id":"kdm-w1k.3","title":"Expand resource rewards to all monsters","description":"Add resource reward data for all quarry monsters once proof of concept is validated. Research and add reward tables for each monster/level.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-07T19:58:42.145223+01:00","updated_at":"2025-12-10T04:20:45.250923+01:00","closed_at":"2025-12-10T04:20:45.250923+01:00","dependencies":[{"issue_id":"kdm-w1k.3","depends_on_id":"kdm-w1k","type":"parent-child","created_at":"2025-12-07T19:58:42.147451+01:00","created_by":"daemon"},{"issue_id":"kdm-w1k.3","depends_on_id":"kdm-w1k.1","type":"blocks","created_at":"2025-12-07T19:58:51.792209+01:00","created_by":"daemon"}]}
{"id":"kdm-w1k.4","title":"Refactor Rules button creation to shared utility","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T10:48:06.287178+01:00","updated_at":"2025-12-09T01:15:25.001533+01:00","closed_at":"2025-12-09T01:15:25.001533+01:00","dependencies":[{"issue_id":"kdm-w1k.4","depends_on_id":"kdm-w1k","type":"parent-child","created_at":"2025-12-08T10:48:06.292085+01:00","created_by":"daemon"}]}
{"id":"kdm-xwb","title":"TTSTests.ttslua refactoring (extract TestRegistry, TestInfrastructure)","description":"TTSTests.ttslua exceeds 500-line threshold (558 lines). Refactoring-advisor identified priority 0 extractions:\n\n## R1: Extract TestRegistry\n- Move ALL_TESTS definition + discovery functions to Util/TestRegistry.ttslua\n- Functions: DiscoverTestsByBead, GetBeadTestCounts, PrintAllTests, PrintBeadSuites\n- ~72 lines reduction\n\n## R2: Extract TestInfrastructure\n- Move error capture functions to Util/TestInfrastructure.ttslua\n- Functions: startErrorCapture, stopErrorCapture\n- ~17 lines reduction\n\nExpected result: TTSTests.ttslua reduced to ~469 lines (below threshold).\n\nSee handover/LATEST_REVIEW.md for full refactoring-advisor analysis.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-13T23:18:58.709573+01:00","updated_at":"2025-12-14T00:59:17.616998+01:00","closed_at":"2025-12-14T00:59:17.616998+01:00","comments":[{"id":2,"issue_id":"kdm-xwb","author":"ilja","text":"Closing: Architect verified design compliance - TTSTests reduced from 558 to 381 lines, TestRegistry and TestErrorCapture extracted successfully, all 238 tests pass, no regressions","created_at":"2025-12-13T23:59:13Z"}]}
